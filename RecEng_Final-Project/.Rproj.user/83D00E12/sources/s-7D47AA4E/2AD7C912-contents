---
title: "Data Visualization for Youth Employement in LATAM"
author: "Group F"
date: "January 17th, 2019"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)

if(!"waffle" %in% installed.packages()) {install.packages("waffle")}
library(waffle)

if(!"gridExtra" %in% installed.packages()) {install.packages("gridExtra")}
library(gridExtra)

if(!"grid" %in% installed.packages()) {install.packages("grid")}
library(grid)

if(!"ggplot2" %in% installed.packages()) {install.packages("ggplot2")}
library(ggplot2)

if(!"ggthemes" %in% installed.packages()) {install.packages("ggthemes")}
library(ggthemes)

if(!"ggExtra" %in% installed.packages()) {install.packages("ggExtra")}
library(ggExtra)

if(!"psych" %in% installed.packages()) {install.packages("psych")}
library(psych)

if(!"reshape2" %in% installed.packages()) {install.packages("reshape2")}
library(reshape2)

if(!"tidyr" %in% installed.packages()) {install.packages("tidyr")}
library(tidyr)

if(!"scales" %in% installed.packages()) {install.packages("scales")}
library(scales)

if(!"ggalt" %in% installed.packages()) {install.packages("ggalt")}
library(ggalt)

if(!"dplyr" %in% installed.packages()) {install.packages("dplyr")}
library(dplyr)

library(RColorBrewer)

```

## Economically Active Youth Population in Latin America

### Introduction

The following report consists of a series of graphical representations that delineate youth employment in Latin America (LATAM) for ages between 15 and 24. All insights presented herein are derived from the data set "Youth Employment in LATAM", available [here](https://onedrive.live.com/view.aspx?resid=43EBDBC5D5265516!11616&ithint=file%2cxlsx&app=Excel&wdo=2&authkey=!AM_69TO197rq6_w).

The data consists of figures for each Latin american country, ranging from 2013 to 2015. Metrics explored in this report consider demographics such as sex and country, as well as occupation status, occupation industry and occupation sector.

Occupation status is classified into:
 
  * **Economically Active (EA)**: referring to youths that are, or have at some stage been in active employment
  * **NiNi**: referring to youths that are out of education and not in employment, but are likely to be in search for employment 
  * **NiNiNi**: referring to youths that are out of education, not in employment and unlikely to be in search for employment
  * **Unemployed**: referring to youths that have at some stage been in active employment, but are currently out of employment
  * **Employed**: Consisting to the groups *Formally Employed* and *Informally Employed*
    + **Formally Employed**: referring to youths that are officially registered in formal employment
    + **Informally Employed**: referring to the remaining employed youths that are in employment, but not officially registered therein.

    
### Economic Activity by Country

Insights derived from the following visual representations tell a compelling story of the socio-economic reality for Latin american youth. In total, the region has over 70 million youth aged between 15 and 24 years. More than 50 million of those are considered economically active youth -- that is, they are employed or are looking for employment. From the small-multiple waffle chart below, it can be seen that roughly one in five young people identify with the occupation status NiNi, underlining a significant lack of gainful employment for the young workforce in the region. 

```{r waffle small multiples, echo = F, message = FALSE}

total <- read.csv("https://gist.githubusercontent.com/tomastello/ed6548f728309bbdf5dc976abe51f56e/raw/1dfdd3fac4db97d2548ed79e5bf54e8f305bd03a/Youth%2520Employement%2520LATAM%2520Total")

country_population <- total
country_population <- country_population[,c("Economically.Active.Population","Ninis")]
row.names(country_population) <- total$Country
country_population$Economically.Active.Population <- round(country_population$Economically.Active.Population/total$Total.population * 100, 0)
country_population$Ninis <- round(country_population$Ninis/total$Total.population * 100, 0)

waffle_list<-list()

for (i in 1:(nrow(country_population))){
    waffle_list[[i]]<-waffle(c(`EA` = country_population[i,1], `Nini` = country_population[i,2]), rows = 6,
                          size = 1, colors = c("steelblue", "grey"), xlab = "1 square = 1 percent", title = 
                           row.names(country_population[i,]))
}
#Print plots
grid.arrange(grobs=waffle_list[0:12], ncol=3, nrow=4)
grid.arrange(grobs=waffle_list[13:19], ncol=3, nrow=4)
#dev.off()
```

It is further clear from the graph above which countries have a greater proportion of Economically Active ("EA") individuals vs. individuals who are neither currently enrolled in an educational course nor are working ("Nini") among the 15-24 age band. 

Countries such as Bolivia, Peru, and Paraguay lead in this regard by having a higher proportion of EA young individuals implying a greater portion of their youth population are either currently working or are unemployed (i.e. do not currently have a job, but are actively seeking work). 

Conversely countries such as Argentina, El Salvador, Jamaica, and Venezuela have a greater proportion of Ninis implying that a greater portion of their youth populations do not have an education nor work with a subset not even actively searching for work. These gaps could possibly be attributed to the health of each countries' job market, which is affected by various political, geopolitical, and macroeconomic factors. 


### Employment Status by Country

From the group that identifies as Economically Active (represented by the blue tiles in the previous graph), roughly every fifth has become unemployed. As can be seen in the bar chart below, some countries across the continent have a higher proportion of unemployment to employment than others.This further emphasizes the economic hardship faced by the young generation in many countries across Latin America. 

```{r bar chart, echo=FALSE}
# Create a new data set with the subset of population that are economically active
x <- as.data.frame(total$Country)
x[,2] <- round(total$Employed / 1000000, digits=2)
x[,3] <- round(total$Unemployed / 1000000, digits=2)
x[,4] <- total$Economically.Active.Population / sum(total$Economically.Active.Population)
colnames(x)<- c('Country', 'Employed', 'Unemployed', 'Percent.Economically.Active')
sub<- x[order(-x$Percent.Economically.Active),][1:5,]
sub$Country<-factor(sub$Country, levels=sub$Country)

# Create a new data set that shows categories

emp<- as.data.frame(sub$Country)
emp[,2]<- rep("Employed", nrow(emp))
emp[,3]<- as.data.frame(sub$Employed)
emp[,4]<- as.data.frame(sub$Percent.Economically.Active)
colnames(emp)<-c("Country", "Category", "Population", "Percent.Economically.Active")

unemp<- as.data.frame(sub$Country)
unemp[,2]<- rep("Unemployed", nrow(emp))
unemp[,3]<- as.data.frame(sub$Unemployed)
unemp[,4]<- as.data.frame(sub$Percent.Economically.Active)
colnames(unemp)<-c("Country", "Category", "Population", "Percent.Economically.Active")

econ_active<-rbind(emp,unemp)
econ_active<- econ_active[order(-econ_active$Percent.Economically.Active, econ_active$Country),]
Economically.Active<-rbind(data.frame(Country="All countries", Category="Employed", Population=sum(emp$Population), Percent.Economically.Active=1), data.frame(Country="All countries", Category="Unemployed", Population=sum(unemp$Population), Percent.Economically.Active=1), econ_active)

# Plot grouped bar graph using ggplot

ggplot(Economically.Active, aes(fill=Category, y=Population, x=Country)) + 
  geom_bar( position="dodge", stat="identity") +
  geom_text(aes(label=Population), position=position_dodge(width=0.9), size = 4, vjust=-0.5) +
  scale_fill_manual(values = c("steelblue","grey")) +
  theme_bw() +
  theme(panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"))


```

Notably,  Brazil and Mexico together constitute 50% of the employment demographic, largely due to the high overall country population in these regions. With a booming youth demographic, there is potential and more still, a growing need to increase gainful employment for the workforce in the region. 


### Employment by Country and Formality

To make things worse, there is a general trend where countries that have a stronger percentage of employment - roughly between 85% to 95% - carry a far higher proportion of informal employment. Thus Guatemala boasts a youth employment rate of 95%, only 20% of these however are formally employed and registered to pay taxes. 

```{r scatterplot per country, echo=FALSE}

Employment <- read.csv("https://gist.githubusercontent.com/tomastello/ed6548f728309bbdf5dc976abe51f56e/raw/0fccb39194874789ef52ca8bff1e134865afa41c/Youth%2520Employement%2520LATAM%2520Total", sep = ",")

Employment$Employment_index <- Employment$Employed/Employment$Economically.Active.Population
Employment$Formal_Employment_index <- Employment$Formal / Employment$Employed
Employment <- Employment[-c(11),]

ggplot(Employment, aes(x= Employment$Formal_Employment_index, y= Employment$Employment_index)) +
  geom_point(color="steelblue", aes(size = Employment$Economically.Active.Population), alpha=.5)+
  scale_size(range = c(1,30))+
  labs(x=element_blank(), y=element_blank())+
  theme(panel.background = element_blank(),panel.grid = element_blank(),legend.title = element_blank(), legend.position = "none")+
  geom_text(aes(label = Country), size = 3)+
  geom_hline(yintercept = mean(Employment$Employment_index), linetype = "dashed", color = "black")+
  geom_vline(xintercept = mean(Employment$Formal_Employment_index), linetype = "dashed", color = "black")+
  annotate("text", x=0.63, y= 0.863, label = "More Formal",color="black")+
  annotate("text", x=0.1, y= 0.863, label = "Less Formal",color="black")+
  annotate("text", x=0.32, y= 0.75, label = "Low Employment",color="black")+
  annotate("text", x=0.32, y= 0.96, label = "High Employment",color="black")
```

Further, we can see a negative relationship between Employment Index and the percentage of Formally Employed workers. The countries with the highest employment rates show the lowest rates of Formal Employment.

Due to the recent economic crisis, the country with the highest number of Economically Active Population, Brazil shows the lowest employment index in the region. However, it still shows high indexes of formal employment

Ecuador and Dominican Republic are the only countries mapped in the positive quadrant, marking them out to have a relative high employment rate, that is nevertheless formal. In contrast, Colombia shows a clear need to address unemployment as well as formality.


### Economic Activity by Country and Gender

Next to the evident lack of gainful, formal employment, an even stronger disparity comes to light when viewing the significant gap between young economically active men and woman within the region, represented by the dumbbell chart below. 

```{r dumbell gender, echo=FALSE}


# Load Data (YOUTH EMPLOYMENT IN LATAM)

total <- read.csv("https://gist.githubusercontent.com/tomastello/ed6548f728309bbdf5dc976abe51f56e/raw/1dfdd3fac4db97d2548ed79e5bf54e8f305bd03a/Youth%2520Employement%2520LATAM%2520Total")
female <- read.csv("https://gist.githubusercontent.com/tomastello/e5124f0613076b36bd9a0d42f4657061/raw/1d1c71aebd3d9ea9e53804a2314a7d7360abe452/Youth%2520Employement%2520LATAM%2520Female")
male <- read.csv("https://gist.githubusercontent.com/tomastello/be03454180cd6186d31665ba1f0644d4/raw/44cd2434f8d171b115cf3185fb4aa2338bb59fe8/Youth%2520Employement%2520LATAM%2520Male")


# Extract Data - Female/Male Economically Active Ratio

Female_Econ_Act_percent <- data.frame(female$Country,female$Economically.Active.Population/female$Total.population)
#head(Female_Econ_Act_percent)

Male_Econ_Act_percent <- data.frame(male$Country,male$Economically.Active.Population/male$Total.population)
#head(Male_Econ_Act_percent)

Join_Econ_Act_percent<-merge(x=Female_Econ_Act_percent, y=Male_Econ_Act_percent, by.x='female.Country', by.y='male.Country')
#head(Join_Econ_Act_percent)

colnames(Join_Econ_Act_percent) <- c("Country_Code", "Econ_Active_Female", "Econ_Active_Male")

Join_Econ_Act_percent$Econ_Act_Diff <- (Join_Econ_Act_percent$Econ_Active_Male - Join_Econ_Act_percent$Econ_Active_Female)
#head(Join_Econ_Act_percent)

# Order Data By Econ Active Females Descending

Join_Econ_Act_percent<-Join_Econ_Act_percent[order(-Join_Econ_Act_percent$Econ_Active_Female),]

Join_Econ_Act_percent$Country_Code <- factor(Join_Econ_Act_percent$Country_Code, levels=as.character(Join_Econ_Act_percent$Country_Code))  # for right ordering of the dumbells
#head(Join_Econ_Act_percent)

# Order Data By Econ Active Difference
# Join_Econ_Act_percent<-Join_Econ_Act_percent[order(Join_Econ_Act_percent$Econ_Act_Diff),]
# 
# Join_Econ_Act_percent$Country_Code <- factor(Join_Econ_Act_percent$Country_Code, levels=as.character(Join_Econ_Act_percent$Country_Code))  # for right ordering of the dumbells
# head(Join_Econ_Act_percent)

# Creating the Female/Male Economically Active Ratio Dumbbell chart

ggplot(Join_Econ_Act_percent, aes(x=Econ_Active_Female, xend=Econ_Active_Male, y=Country_Code, group=Country_Code)) + 
  geom_dumbbell(colour="black", size=0.5, colour_xend="steelblue", size_xend = 3,
                dot_guide=TRUE, dot_guide_size=0.5, dot_guide_colour = "grey") + 
  scale_x_continuous(label=percent) + 
  labs(x=NULL, y=NULL) +
  theme_tufte()


```

On average, less than 60% of young Latin american woman are classified as economically active. In most extreme countries, such as Guatemala less than 40% of woman are economically active, compared to 90% economically active men. While on the one hand this lack of young female employment might constitute considerable unused economic potential, it also maximizes pressure on the existing male workforce to provide for their families within what is already a harsh economic reality.


### Youth Employment by Country and Industry

Part of these disparities might be explained by volatile industries. 

```{r waffle General Industry, echo = F, message = FALSE}

# Create a list with the names of the industries
industryNames = c("Agriculture, hunting, forestry and fishing",
                 "Exploitation of mines and quarries",
                 "Manufacturing industry",
                 "Electricity, gas and water",
                 "Construction",
                 "Commerce, restaurants and hospitality",
                 "Transportation and storage",
                 "Financial establishments and insurance",
                 "Social and community services")


totalIndustries = NULL

# Get the total amount of workers per industry from the data
for(i in 1:9) {
  totalIndustries[i] = sum(total[,(9+i)])
}
totalIndustry = sum(total$Total.Industry)


# Create a dataframe with the numbers per industry, with 2 columns: the amount of workers and the name of the industry
df_total_industry = as.data.frame(industryNames,stringsAsFactors = F)
df_total_industry$amountPerIndustry = totalIndustries


# Sort the dataframes by the amount of total workers
df_total_industry = df_total_industry[order(df_total_industry$amountPerIndustry, decreasing = T),]

# Divide the numbers by 100.000, for the waffle charts, so each square represents 100.000 people
df_total_industry$amountPerIndustry = round(df_total_industry$amountPerIndustry / 100000)


# Draw the waffle charts
waffle(df_total_industry$amountPerIndustry, rows=20, xlab="1 square = 100.000 people", title = "Youth Employment in Latin America by Industry") + scale_fill_manual(values=append(brewer.pal(n = 9, name = "Set1"),"white"), name="Industry", labels = append(df_total_industry$industryNames, ""))



```

As can be seen from the waffle chart above, roughly half of the youth employment industry focuses on the categories "Commerce, restaurants and hospitality" and "Social and community services", leaving industries such as "Construction" and "Transportation and storage" trailing behind, despite of the growing need in infrastructure such as roads, train lines and affordable housing to stimulate the economy.

The tufte box plot below again corroborates this across the continent.

```{r tufte box plots, echo=FALSE}
data_total <- read.csv("https://gist.githubusercontent.com/tomastello/ed6548f728309bbdf5dc976abe51f56e/raw/0fccb39194874789ef52ca8bff1e134865afa41c/Youth%2520Employement%2520LATAM%2520Total")


#selecting the needed data (country+employed number of different sectors)
data_sector<-data_total[ ,10:19]
data_country<-data_total[ ,1]
data_sector_country<-cbind(data_country,data_sector)

#create new variables (employment prcentage) for each sector
data_sector_country$Agriculture.hunting.forestry.and.fishing<-data_sector_country$Agriculture..hunting..forestry.and.fishing.sector/data_sector_country$Total.Industry
data_sector_country$Exploitation.of.mines.and.quarries<-data_sector_country$Exploitation.of.mines.and.quarries.sector/data_sector_country$Total.Industry
data_sector_country$Manufacturing.industry<-data_sector_country$Manufacturing.industry.sector/data_sector_country$Total.Industry
data_sector_country$Electricity.gas.and.water<-data_sector_country$Electricity..gas.and.water.sector/data_sector_country$Total.Industry
data_sector_country$Construction<-data_sector_country$Construction.sector/data_sector_country$Total.Industry
data_sector_country$Commerce.restaurants.and.hospitality<-data_sector_country$Commerce..restaurants.and.hospitality.sector/data_sector_country$Total.Industry
data_sector_country$Transportation.and.storage<-data_sector_country$Transportation.and.storage.sector/data_sector_country$Total.Industry
data_sector_country$Financial.establishments.and.insurance<-data_sector_country$Financial.establishments.and.insurance.sector/data_sector_country$Total.Industry
data_sector_country$Social.and.community.services<-data_sector_country$Social.and.community.services.sector/data_sector_country$Total.Industry

#rearrange the data table
data_sector1<-data_sector_country[ ,12:20]
data_country<-data_total[ ,1]
data_sector_country1<-cbind(data_country,data_sector1)
sector_tufte<-melt(data_sector_country1,id=c("data_country"))
colnames(sector_tufte)[colnames(sector_tufte)=="variable"] <- "Sector"
colnames(sector_tufte)[colnames(sector_tufte)=="value"] <- "Employment_Percentage"

#plot the minimal boxpolot for sector versus employment percentage for each sector among coutries with ggplot
A<-ggplot(sector_tufte, aes(x=reorder(Sector, Employment_Percentage, FUN = median),y=Employment_Percentage)) + 
  theme_tufte(base_size = 7, ticks=F) +
  geom_tufteboxplot(outlier.colour="transparent", size=0.7, color= "steelblue") + 
  annotate("text", x = 10, y = 0.5, adj=1,  family="serif", label = c(""))+
  labs(x="Sector",y="Employment_percentage")

B<-A + theme(
  plot.title = element_text(color="black", size=14, face="bold.italic"),
  axis.title.x = element_text(color="black", size=10, face="bold"),
  axis.title.y = element_text(color="black", size=10, face="bold"),
  axis.text.x = element_text(size=9),
  axis.text.y = element_text(size=9)
)

B+coord_flip()



```

Vital industries such as "Electricity, Gas and Water" as well as "Transportation and Storage" and "Construction" are lagging behind, demonstrating a general lack of infrastructure across the continent.

The low-paying commerce industry has the highest median employment rate and with compact performance across the continent. This might explain the high rate of unofficial employment explored before, due to the ease of employing unregistered workforce in commerce areas such as restaurants and hospitality. The relative ease of being employed in places such as restaurants also demonstrates the lack of other viable opportunities for the young generation.

Interestingly agriculture industry has the most dispersive employment range across the continent. This might reflect the diverging levels of urbanization across different Latin American countries and again points to a systemic lack of infrastructure in countries with lower urbanization.

## Employment distribution per Country and Sector

As can be seen by the waffle and tufte graphs below, this story is again corroborated by data from the different occupation sectors, which neatly map onto the different industries.

```{r waffle General Occupation, echo = F, message = FALSE}


# Create a list with the names of the occupations
occupationNames = c("Professional and technical level",
                    "Director or senior official level",
                    "Administrative and intermediate level",
                    "Merchants and vendors",
                    "In services",
                    "Agricultural workers",
                    "Non-agricultural workers, machine drivers",
                    "Armed forces",
                    "Other employment types")

totalOccupations = NULL

# Get the total amount of workers per industry and occupation from the data
for(i in 1:9) {
  totalOccupations[i] = sum(total[,(19+i)])
}

totalOccupation = sum(total$Total.Employment.Type)


# Create a dataframe with the numbers per occupation, with 2 columns: the amount of workers and the name of the occupation
df_total_occupation = as.data.frame(occupationNames,stringsAsFactors = F)
df_total_occupation$amountPerOccupation = totalOccupations


# Sort the dataframes by the amount of total workers
df_total_occupation = df_total_occupation[order(df_total_occupation$amountPerOccupation, decreasing = T),]

# Divide the numbers by 100.000, for the waffle charts, so each square represents 100.000 people
df_total_occupation$amountPerOccupation = round(df_total_occupation$amountPerOccupation / 100000)

# Draw the waffle charts

waffle(df_total_occupation$amountPerOccupation, rows=20, xlab="1 square = 100.000 people") + scale_fill_manual(values=append(brewer.pal(n = 9, name = "Set1"),"white"), name="Occupation", labels = append(df_total_occupation$occupationNames, ""))

```

Similar to the industries, other employment types only make up a small fraction of the overall workforce, again emphasizing the systemic lack of opportunity for the young generations in Latin America.


```{r tufte box plots per occupation, echo=FALSE}
#selecting the needed data (country+employed number of different occupations)
data_occupation<-data_total[ ,20:29]
data_country<-data_total[ ,1]
data_occupation_country<-cbind(data_country,data_occupation)

#create new variables (employment prcentage) for each occupation
data_occupation_country$Professional.Technical.level<-data_occupation_country$Professional.and.technical.level/data_occupation_country$Total.Employment.Type
data_occupation_country$Director.Senior.official.level<-data_occupation_country$Director.or.senior.official.level/data_occupation_country$Total.Employment.Type
data_occupation_country$Administrative.Intermediate.levele<-data_occupation_country$Administrative.and.intermediate.level/data_occupation_country$Total.Employment.Type
data_occupation_country$Merchants.Vendors<-data_occupation_country$Merchants.and.vendors/data_occupation_country$Total.Employment.Type
data_occupation_country$In.Services<-data_occupation_country$In.services/data_occupation_country$Total.Employment.Type
data_occupation_country$Agricultural.Workers<-data_occupation_country$Agricultural.workers/data_occupation_country$Total.Employment.Type
data_occupation_country$NonAgricultural.Workers.Machine.Drivers<-data_occupation_country$Non.agricultural.workers..machine.drivers/data_occupation_country$Total.Employment.Type
data_occupation_country$Armed.forces<-data_occupation_country$Armed.Forces/data_occupation_country$Total.Employment.Type


#rearrange the data table
data_occupation1<-data_occupation_country[ ,12:19]
data_country<-data_total[ ,1]
data_occupation_country1<-cbind(data_country,data_occupation1)
occupation_tufte<-melt(data_occupation_country1,id=c("data_country"))
colnames(occupation_tufte)[colnames(occupation_tufte)=="variable"] <- "Occupation"
colnames(occupation_tufte)[colnames(occupation_tufte)=="value"] <- "Employment_Percentage"

#plot the minimal boxpolot for occupation versus employment percentage for each sector among coutries with ggplot
C<-ggplot(occupation_tufte, aes(x=reorder(Occupation, Employment_Percentage, FUN = median),y=Employment_Percentage)) + 
  theme_tufte(base_size = 7, ticks=F) +
  geom_tufteboxplot(outlier.colour="transparent", size=0.7, color= "steelblue") + 
  annotate("text", x = 9, y = 0.6, adj=1,  family="serif", label = c(""))+
  labs(x="Occupation",y="Employment_percentage")

D<-C + theme(
  plot.title = element_text(color="black", size=14, face="bold.italic"),
  axis.title.x = element_text(color="black", size=10, face="bold"),
  axis.title.y = element_text(color="black", size=10, face="bold"),
  axis.text.x = element_text(size=7),
  axis.text.y = element_text(size=9)
)

D+coord_flip()

```

The tufte chart above again presents the strong divergence in agricultural work. It can also be derived that some countries have next to no senior official workforce, suggesting that industry of some Latin American countries is dominated by other nationalities.


## Conclusion

This report delineated the youth employment situation in Latin America (LATAM) for ages between 15 and 24, based on data that was collected from 2013 to 2015. The dire state of the employment situation is outlined by the high proportion of unemployment, informal employment, lack of female employment and lack of industrial diversity. Many of these factors point to a systemic lack of infrastructure as well as gainful economic opportunities for the youth. 

To regain a path of sustainable hope for the young generations, Latin America must invest more into opportunities for the youth, encouraging young woman to join the workforce. Job markets must be established where countries set focus on raising the level of formal job opportunities that present a hopeful and sustainable future for young job seekers as well as a viable alternative to informal work. Taxes raised by increasing the proportion of formal employment can be invested into infrastructure to stimulate the job market.




